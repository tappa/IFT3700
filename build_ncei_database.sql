CREATE DATABASE NCEI;
USE NCEI;

CREATE TABLE Station (
    id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    station VARCHAR(11) UNIQUE NOT NULL,
    name VARCHAR(255) NOT NULL,
    latitude FLOAT(5,3) NOT NULL,
    longitude FLOAT(6,3) NOT NULL,
    elevation FLOAT(6,2) NOT NULL
);

CREATE TABLE Quality (
    id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    code VARCHAR(1) UNIQUE NOT NULL,
    description VARCHAR(255) NOT NULL
);

CREATE TABLE Wind_Direction_Type (
    id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    code VARCHAR(1) UNIQUE NOT NULL,
    description VARCHAR(255) NOT NULL
);

CREATE TABLE CIG_Height_Determination (
    id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    code VARCHAR(1) UNIQUE NOT NULL,
    description VARCHAR(255) NOT NULL
);

CREATE TABLE CIG_CAVOK (
    id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    code VARCHAR(1) UNIQUE NOT NULL,
    description VARCHAR(255) NOT NULL
);

CREATE TABLE VIS_Variability (
    id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    code VARCHAR(1) UNIQUE NOT NULL,
    description VARCHAR(255) NOT NULL
);

CREATE TABLE Meteo (
    id INT PRIMARY KEY NOT NULL AUTO_INCREMENT,
    
    station_id INT NOT NULL,
    FOREIGN KEY (station_id) REFERENCES Station(id),
    hour DATETIME NOT NULL,
    CONSTRAINT UNIQUE (station_id,hour),
    
    wnd_dir INT NOT NULL,
    wnd_dir_qual INT NOT NULL,
    FOREIGN KEY (wnd_dir_qual) REFERENCES Quality(id),
    wnd_dir_type INT NOT NULL,
    FOREIGN KEY (wnd_dir_type) REFERENCES Wind_Direction_Type(id),
    wnd_speed INT NOT NULL,
    wnd_speed_qual INT NOT NULL,
    FOREIGN KEY (wnd_speed_qual) REFERENCES Quality(id),
    
    cig_height INT NOT NULL,
    cig_height_qual INT NOT NULL,
    FOREIGN KEY (cig_height_qual) REFERENCES Quality(id),
    cig_height_dete INT NOT NULL,
    FOREIGN KEY (cig_height_dete) REFERENCES CIG_Height_Determination(id),
    cig_cavok INT NOT NULL,
    FOREIGN KEY (cig_cavok) REFERENCES CIG_CAVOK(id),
    
    vis_dis INT NOT NULL,
    vis_dis_qual INT NOT NULL,
    FOREIGN KEY (vis_dis_qual) REFERENCES Quality(id),
    vis_var INT NOT NULL,
    FOREIGN KEY (vis_var) REFERENCES VIS_Variability(id),
    vis_var_qual INT NOT NULL,
    FOREIGN KEY (vis_var_qual) REFERENCES Quality(id),
    
    tmp INT NOT NULL,
    tmp_qual INT NOT NULL,
    FOREIGN KEY (tmp_qual) REFERENCES Quality(id),
    
    dew INT NOT NULL,
    dew_qual INT NOT NULL,
    FOREIGN KEY (dew_qual) REFERENCES Quality(id),
    
    slp INT NOT NULL,
    slp_qual INT NOT NULL,
    FOREIGN KEY (slp_qual) REFERENCES Quality(id)
);

INSERT INTO Station (station,name,latitude,longitude,elevation) VALUES
('72520094823','PITTSBURGH ASOS, PA US',40.4846,-80.2144,366.7),
('94312099999','PORT HEDLAND INTERNATIONAL, AS',-20.377778,118.626389,10.05),
('70271026425','GULKANA AIRPORT, AK US',62.1591,-145.4588,476.1),
('94910099999','WAGGA WAGGA, AS',-35.165278,147.466389,220.67),
('94653099999','CEDUNA AMO, AS',-32.1333333,133.7,16.0),
('8509099999','LAJES, PO',38.761842,-27.090797,54.86),
('91182022521','HONOLULU INTERNATIONAL AIRPORT, HI US',21.324,-157.9294,2.1),
('70398025308','ANNETTE WEATHER SERVICE OFFICE AIRPORT, AK US',55.0389,-131.5787,33.2),
('72263023034','SAN ANGELO MATHIS FIELD, TX US',31.35167,-100.495,584.0),
('72266013962','ABILENE REGIONAL AIRPORT, TX US',32.4105,-99.6822,545.6),
('48354099999','UDON THANI, TH',17.386436,102.788247,176.47),
('94374099999','ROCKHAMPTON, AS',-23.381944,150.475278,10.36),
('94403099999','GERALDTON, AS',-28.796111,114.7075,36.88),
('72251012924','CORPUS CHRISTI INTERNATIONAL AIRPORT, TX US',27.7742,-97.5122,13.4),
('72509014739','BOSTON, MA US',42.3606,-71.0097,3.7),
('72306013722','RALEIGH AIRPORT, NC US',35.8923,-78.7819,126.8),
('94907099999','EAST SALE, AS',-38.098889,147.149444,7.01),
('72356013968','TULSA INTERNATIONAL AIRPORT, OK US',36.1994,-95.8872,198.1),
('94300099999','CARNARVON AIRPORT, AS',-24.8833333,113.6666666,8.0),
('72363023047','AMARILLO INTERNATIONAL AIRPORT, TX US',35.2295,-101.7042,1098.5),
('70350025501','KODIAK AIRPORT, AK US',57.75111,-152.48556,24.4),
('72259513911','FORT WORTH NAS, TX US',32.76667,-97.45,185.3),
('72250012919','BROWNSVILLE S PADRE ISLAND INTERNATIONAL AIRPORT, TX US',25.9141,-97.423,7.3),
('94203099999','BROOME INTERNATIONAL, AS',-17.944722,122.231667,17.06),
('70219026615','BETHEL AIRPORT, AK US',60.785,-161.8293,31.1),
('72297023129','LONG BEACH DAUGHERTY AIRPORT, CA US',33.8116,-118.1463,9.4),
('78367011706','GUANTANAMO BAY NAS, CU',19.9,-75.15,39.9),
('70261026411','FAIRBANKS INTERNATIONAL AIRPORT, AK US',64.8039,-147.8761,131.7),
('94212099999','HALLS CREEK AIRPORT, AS',-18.2333333,127.6666666,424.0),
('72231012916','NEW ORLEANS INTERNATIONAL AIRPORT, LA US',29.997528,-90.277806,1.2),
('72344013964','FORT SMITH REGIONAL AIRPORT, AR US',35.333,-94.3625,136.9),
('72290693112','NORTH ISLAND NAS, CA US',32.7,-117.2,7.9),
('70267026415','BIG DELTA AIRPORT, AK US',63.9944,-145.7214,389.2),
('72572024127','SALT LAKE CITY INTERNATIONAL AIRPORT, UT US',40.7781,-111.9694,1287.8),
('72253012921','SAN ANTONIO INTERNATIONAL AIRPORT, TX US',29.5443,-98.4839,240.5),
('72464093058','PUEBLO MEMORIAL AIRPORT, CO US',38.2901,-104.4983,1438.7),
('70326025503','KING SALMON AIRPORT, AK US',58.6829,-156.6563,20.4),
('94510099999','CHARLEVILLE, AS',-26.413334,146.2625,305.71),
('94926099999','CANBERRA, AS',-35.306944,149.195,574.85),
('94637099999','KALGOORLIE BOULDER, AS',-30.789444,121.461667,366.67),
('94821099999','MOUNT GAMBIER AERO, AS',-37.7333333,140.7833333,69.0),
('70026027502','BARROW W POST W ROGERS AIRPORT, AK US',71.2834,-156.7815,9.4),
('94120099999','DARWIN INTERNATIONAL, AS',-12.414722,130.876667,31.39),
('72265023023','MIDLAND INTERNATIONAL AIRPORT, TX US',31.9475,-102.2086,872.3),
('47110099999','GIMPO, KS',37.558311,126.790586,17.67),
('94865099999','LAVERTON RAAF, AS',-37.8666666,144.75,20.0);

INSERT INTO Quality (code,description) VALUES
('0','Passed gross limits check'),
('1','Passed all quality control checks'),
('2','Suspect'),
('3','Erroneous'),
('4','Passed gross limits check, data originate from an NCEI data source'),
('5','Passed all quality control checks, data originate from an NCEI data source'),
('6','Suspect, data originate from an NCEI data source'),
('7','Erroneous, data originate from an NCEI data source'),
('9','Passed gross limits check if element is present');

INSERT INTO Wind_Direction_Type (code,description) VALUES
('A','Abridged Beaufort'),
('B','Beaufort'),
('C','Calm'),
('H','5-Minute Average Speed'),  
('N','Normal'),
('R','60-Minute Average Speed'), 
('Q','Squall'),
('T','180 Minute Average Speed'), 
('V','Variable'),
('9','Missing');

INSERT INTO CIG_Height_Determination (code,description) VALUES
('A','Aircraft'),
('B','Balloon'),
('C','Statistically derived'),
('D','Persistent cirriform ceiling (pre-1950 data)'),
('E','Estimated'),
('M','Measured'),
('P','Precipitation ceiling (pre-1950 data)'),
('R','Radar'),
('S','ASOS augmented'),
('U','Unknown ceiling (pre-1950 data)'),
('V','Variable ceiling (pre-1950 data)'),
('W','Obscured'),
('9','Missing');

INSERT INTO CIG_CAVOK (code,description) VALUES
('N','No'),
('Y','Yes'),
('9','Missing');

INSERT INTO VIS_Variability (code,description) VALUES
('N','Not variable'),
('Y','Variable'),
('9','Missing');